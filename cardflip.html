<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Card Flip Game</title>
    <style>
        body {
            margin: 0;
            font-family: "Segoe UI", sans-serif;
            overflow: hidden;
        }

        code {
            font-family: "Courier New", monospace;
        }

        #cards {
            margin: auto;
            border: solid 1px grey;
            border-radius: 10px;
        }

        td {
            width: 80px;
            height: 120px;
            color: white;
            background: black;
            transition: all 0.2s ease-in;
            border-radius: 10px;
            border: solid 1px grey;
            text-align: center;
        }

        td.active {
            transform: rotateY(180deg);
        }

        td.hidden {
            transform: translateY(2000px);
            visibility: hidden;
        }

        td:hover {
            box-shadow: yellow 0 0 2px 2px;
        }

        #head {
            text-align: center;
        }

        #head h3 {
            display: inline-block;
            padding: 0 8px;
        }
    </style>
</head>
<body>
    <div id="head">
        <h3 id="points">Points: <code>0</code></h3>
        <h3 id="matches">Matches: <code>0</code></h3>
        <h3 id="time">Time: <code>0s</code></h3>
    </div>
    <table id="cards">
        <tbody>
        <tr>
            <td onclick="updateActive(this)">A1 - 0</td>
            <td onclick="updateActive(this)">A2 - 1</td>
            <td onclick="updateActive(this)">A3 - 2</td>
            <td onclick="updateActive(this)">A4 - 3</td>
        </tr>
        <tr>
            <td onclick="updateActive(this)">B1 - 4</td>
            <td onclick="updateActive(this)">B2 - 5</td>
            <td onclick="updateActive(this)">B3 - 6</td>
            <td onclick="updateActive(this)">B4 - 7</td>
        </tr>
        <tr>
            <td onclick="updateActive(this)">C1 - 8</td>
            <td onclick="updateActive(this)">C2 - 9</td>
            <td onclick="updateActive(this)">C3 - 10</td>
            <td onclick="updateActive(this)">C4 - 11</td>
        </tr>
        <tr>
            <td onclick="updateActive(this)">D1 - 12</td>
            <td onclick="updateActive(this)">D2 - 13</td>
            <td onclick="updateActive(this)">D3 - 14</td>
            <td onclick="updateActive(this)">D4 - 15</td>
        </tr>
        </tbody>
    </table>

    <script>
        const table = document.getElementById("cards");
        const score = document.getElementById("points").lastChild;
        const time = document.getElementById("time").lastChild;
        const matches = document.getElementById("matches").lastChild;

        const counter = setInterval(() => {
            centiseconds++;
            time.innerText = Math.floor(centiseconds / 10) + "s";
        }, 100);

        let cards = [], active = [], pairs = 0, last = 0, points = 0, centiseconds = 0, row, cell, index;

        let colors = [
            "red", "red",
            "yellow", "yellow",
            "green", "green",
            "blue", "blue",
            "orange", "orange",
            "purple", "purple",
            "brown", "brown",
            "pink", "pink"
        ];

        function randomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min)) + min;
        }

        for (row = 0; row < table.rows.length; row++) {
            for (cell = 0; cell < table.rows[row].cells.length; cell++) {
                index = randomInt(0, colors.length - 1);
                table.rows[row].cells[cell].classList.add(colors[index]);
                colors.splice(index, 1)
            }
        }

        function activateCard(card) {
            card.classList.add("active");
            card.style.background = card.style.color = card.classList[0];
        }

        function resetCard(card) {
            card.style.background = "black";
            card.style.color = "white";
            card.classList.remove("active")
        }

        function checkMatches() {
            if (active[0].classList[0] === active[1].classList[0]) {
                active[0].classList.add("hidden");
                active[1].classList.add("hidden");
                pairs++;
                matches.innerText = pairs;

                points = 1000 - (centiseconds - last);
                score.innerText = points;

                last = centiseconds;

                if (pairs === 8) {
                    alert("You win!\nTime: " + centiseconds + "\nPoints: " + points);
                    location.reload()
                }
            } else {
                resetCard(active[0]);
                resetCard(active[1]);
                active = []
            }
        }

        function updateActive(card) {
            if (active.includes(card)) {
                active.splice(active.indexOf(card), 1);
                resetCard(card);
            } else if (active.length < 2) {
                active.push(card);
                activateCard(card);
                if (active.length === 2) {
                    setTimeout(checkMatches, 500);
                }
            } else if (active.length > 1) {
                if (active[0].classList.contains("hidden") && active[1].classList.contains("hidden")) {
                    resetCard(active[0]);
                    resetCard(active[1]);
                }
                active = [card];
                activateCard(card);
            } else {
                active.push(card);
                activateCard(card)
            }
        }

        alert("You have 80 seconds, go!");

        setTimeout(() => {
            clearTimeout(counter);
            alert("Time up!\nYou got " + pairs + "/8 matches.")
        }, 80000)
    </script>
</body>
</html>
